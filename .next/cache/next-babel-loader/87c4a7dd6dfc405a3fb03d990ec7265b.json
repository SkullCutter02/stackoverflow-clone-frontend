{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React, { useState, useEffect } from \"react\";\nimport { useQuery } from \"react-query\";\nimport host from \"../utils/host\";\nimport Community from \"./Community\";\n\nvar Communities = function Communities(_ref) {\n  var filter = _ref.filter;\n\n  var _useState = useState(1),\n      page = _useState[0],\n      setPage = _useState[1];\n\n  var fetchCommunities = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var page,\n          filter,\n          res,\n          data,\n          _args = arguments;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              page = _args.length > 0 && _args[0] !== undefined ? _args[0] : 1;\n              filter = _args.length > 1 && _args[1] !== undefined ? _args[1] : \"\";\n              _context.next = 4;\n              return fetch(\"\".concat(host, \"/communities?page=\").concat(page, \"&limit=10&filter=\").concat(filter));\n\n            case 4:\n              res = _context.sent;\n              _context.next = 7;\n              return res.json();\n\n            case 7:\n              data = _context.sent;\n              return _context.abrupt(\"return\", data);\n\n            case 9:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function fetchCommunities() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var _useQuery = useQuery([\"communities\", page, filter], function () {\n    return fetchCommunities(page, filter);\n  }, {\n    keepPreviousData: true\n  }),\n      isLoading = _useQuery.isLoading,\n      isError = _useQuery.isError,\n      error = _useQuery.error,\n      data = _useQuery.data,\n      isPreviousData = _useQuery.isPreviousData;\n\n  useEffect(function () {\n    setPage(1);\n  }, [filter]);\n  return /*#__PURE__*/_jsxs(React.Fragment, {\n    children: [/*#__PURE__*/_jsx(\"div\", {\n      className: \"jsx-1563327456\" + \" \" + \"communities-container\",\n      children: isLoading ? /*#__PURE__*/_jsx(\"div\", {\n        className: \"jsx-1563327456\",\n        children: \"Loading...\"\n      }) : isError ? /*#__PURE__*/_jsxs(\"div\", {\n        className: \"jsx-1563327456\",\n        children: [\"Error: \", error.message]\n      }) : /*#__PURE__*/_jsxs(React.Fragment, {\n        children: [data.communities.map(function (community) {\n          return /*#__PURE__*/_jsx(Community, {\n            uuid: community.uuid,\n            name: community.name,\n            description: community.description,\n            count: community.posts.length\n          }, community.uuid);\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"jsx-1563327456\" + \" \" + \"page-handlers\",\n          children: [/*#__PURE__*/_jsxs(\"p\", {\n            className: \"jsx-1563327456\" + \" \" + \"current-page\",\n            children: [\"Current Page: \", page]\n          }), /*#__PURE__*/_jsx(\"button\", {\n            onClick: function onClick() {\n              setPage(function (old) {\n                return Math.max(old - 1, 0);\n              });\n              window.scrollTo(0, -500);\n            },\n            disabled: page === 1,\n            className: \"jsx-1563327456\",\n            children: \"Previous Page\"\n          }), /*#__PURE__*/_jsx(\"button\", {\n            onClick: function onClick() {\n              if (!isPreviousData && data.hasMore) {\n                setPage(function (old) {\n                  return old + 1;\n                });\n                window.scrollTo(0, -500);\n              }\n            },\n            disabled: isPreviousData || !data.hasMore,\n            className: \"jsx-1563327456\",\n            children: \"Next Page\"\n          })]\n        })]\n      })\n    }), /*#__PURE__*/_jsx(_JSXStyle, {\n      id: \"1563327456\",\n      children: [\".communities-container.jsx-1563327456{position:relative;margin-bottom:40px;min-height:20px;}\", \".page-handlers.jsx-1563327456{position:absolute;bottom:-20px;right:30px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:28px;width:calc(100% - 30px);-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;-webkit-align-items:flex-end;-webkit-box-align:flex-end;-ms-flex-align:flex-end;align-items:flex-end;}\", \"button.jsx-1563327456{height:70%;width:90px;margin:0 5px;font-size:0.6rem;}\"]\n    })]\n  });\n};\n\nexport default Communities;","map":null,"metadata":{},"sourceType":"module"}